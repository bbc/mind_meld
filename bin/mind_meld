#!/usr/bin/env ruby

require 'pathname'
ENV['BUNDLE_GEMFILE'] ||= File.expand_path(
  '../../Gemfile',
  Pathname.new(__FILE__).realpath
)

$LOAD_PATH << File.expand_path('../../lib', __FILE__)
require 'mind_meld'

url = ENV['HIVEMIND_URL'] || 'http://localhost:3000'
pem = ENV['HIVEMIND_PEM'] || nil
ca_file = ENV['HIVEMIND_CAFILE'] || nil
verify_mode = ENV['HIVEMIND_VERIFY_MODE'] || nil

mm = MindMeld.new(
      url: url,
      pem: pem,
      ca_file: ca_file,
      verify_mode: verify_mode
    )

devs = mm.devices

devs.each do |dev|
  puts "#{dev['id']}) #{dev['name']}"
end
